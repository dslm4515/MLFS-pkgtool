# Final System: Meson
# This section is done in Chroot environment

export PNAME="meson"  &&
export   VER="1.1.0" &&
export  MJOB="-j2"   &&

# Build
pip3 wheel -w dist --no-build-isolation --no-deps $PWD

# Install
pip3 install --no-index --find-links dist meson --root=$BUILD
mkdir -pv $BUILD/usr/share/bash-completion/completions/meson
mkdir -pv $BUILD/usr/share/zsh/site-functions/_meson
install -vDm644 data/shell-completions/bash/meson \
        $BUILD/usr/share/bash-completion/completions/meson
install -vDm644 data/shell-completions/zsh/_meson \
        $BUILD/usr/share/zsh/site-functions/_meson


# Build package
cd ${BUILD} && mkdir -v ${BUILD}/install          &&
cp -v $DESCS/${PNAME} ${BUILD}/install/slack-desc &&
makepkg -l y -c n $PKGS/${PNAME}-${VER}-$PSUFFIX  &&

# Clean stage area
rm -rf ${BUILD}/* &&

# Install
spkg $PKGS/${PNAME}-${VER}-$PSUFFIX
